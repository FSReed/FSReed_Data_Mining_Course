# FSReed_Python_CAD  

本次作业中参考的文档链接为:  
<https://help.autodesk.com/view/OARX/2018/ENU/?guid=GUID-A809CD71-4655-44E2-B674-1FE200B9FE30#GUID-A809CD71-4655-44E2-B674-1FE200B9FE30>
这是AutoCAD Reference Guide文档，里面详细介绍了提供的各种借口，利用pyautocad库对其进行调用即可  
  
在本次作业中，为了方便，选择了4 * 25m = 100m的跨径布置，这样只需要绘制25m的标准T梁图即可  
定义的类以及能够实现的一些方法如下:  
0. File.py:  
最顶层的类，里面存储了以下提到的各种类的对象，可以方便地提取任意一个对象  
具体的类如下:  

1. Basic_shapes.py: 里面包含了一个制作长方形的方法，以及一个精确绘制二次抛物线的方法  
2. Cross_section.py: 定义了一个横截面类，里面有制作横截面的参数化方法，具体见文件内  
3. Elevation.py: 定义了一个立面图类，里面有制作桥梁立面轮廓的参数化方法、添加已有钢束到立面的方法以及添加肋板定位线的方法  
4. Steel_Bram.py: 定义了一个钢束类，里面有制作钢束的参数化方法  
5. Layer.py: 定义了图层类，可以用于存储图层的信息  
6. Paper.py: 定义了图纸类，里面存储了图纸中的各种关键信息，以及制作图纸轮廓、图纸内表格的方法  
7. Dimension.py: 定义了一个标注类, 里面有标注所属的图、制作不同标注的方法  
8. Decorate.py: 定义了一个"修饰"类，其实就是添加一些小标注用的  
  
注意事项!  
注意事项!  
注意事项!  

1. 需要运行的程序是Complete_Solution.py，为了成功运行，请先打开一个完全空白的CAD文件，之后再运行该程序。如果修改后想要重新运行，建议仍然新建一个空白文件再运行，否则可能会有意想不到的后果  
2. 由于调用了pyautocad库，如果运行失败，需要根据CAD版本的不同调整api的参数，参数对照表已经放在同级文件夹中.  
设置方法为:  
      找到pyautocad的api.py，找到app函数，将CAD_Settings图中波浪线标注的地方改成对应自己版本的CAD版本参数  
(如果还不行，在文件夹Python_CAD/CAD_Files中，已经有了运行后的dwg文件：Complete_Solution.dwg，可以打开看看效果)  
3. 不足

- 由于立面、横截面参数化生成标注较繁琐，没有实现，直接在CAD上标注可能更为方便  
- 经查找，可能是64位系统的缘故，设置颜色的接口TrueColor.SetRGB()虽然能运行，但不能实际改变对象的颜色，所以演示dwg文件中的颜色是按图层手动设置的。但是经过程序的参数化建模后，各个对象所属的图层很清楚，所以设置颜色也非常方便  
  
PS: CAD演示文件夹中还有一个25m T梁的标准图，里面有截取尺寸时留下的痕迹
